import requests

url = 'https://facebook.com'
#url = 'http://testphp.vulnweb.com/userinfo.php'
def check_csrf_vuln(url):
    response = requests.request("GET", url)
    resp_header = response.headers
    #"If a web app contains at least one of these headers then it is protected against CSRF"
    searched_headers = ['Access-Control-Allow-Origin','Cross-Origin-Opener-Policy-Report-Only', 'Set-Cookie', 'X-Frame-Options', 'X-Forwarded-Host','Origin','Referer']

    nr_csrf_headers=0

    for key in resp_header.keys():
        if key in searched_headers:
            nr_csrf_headers += 1

    if nr_csrf_headers == 0:
        print("The application has no CSRF protection")
    else:
        print(f'The application presents {nr_csrf_headers} headers that mitigate a CSRF attack.')

check_csrf_vuln(url)
